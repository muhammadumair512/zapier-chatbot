<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Iframe Button Click Counter</title>
  </head>
  <body>
    <!-- Embed your Zapier chatbot iframe -->
    <zapier-interfaces-chatbot-embed
      id="chatbot-embed"
      is-popup="false"
      chatbot-id="cm2yan90j000c7aty144l4g3v"
      height="600px"
      width="400px"
    ></zapier-interfaces-chatbot-embed>

    <script>
      // updated 1
      let clickCount = 0;
      let enterCount = 0;

      // Function to handle button click
      function handleButtonClick() {
        clickCount++;
        console.log(`Button clicked ${clickCount} times.`);
      }

      // Function to handle Enter key press
      function handleEnterKeyPress(event) {
        if (event.key === "Enter") {
          enterCount++;
          console.log(`Enter key pressed ${enterCount} times.`);
        }
      }

      // Ensure the iframe is fully loaded before interacting with it
      function setupChatbotInteractions() {
        const chatbotEmbed = document.querySelector(
          "zapier-interfaces-chatbot-embed"
        );

        if (!chatbotEmbed) {
          console.error("Chatbot embed not found.");
          return;
        }

        chatbotEmbed.addEventListener("load", () => {
          const shadowRoot = chatbotEmbed.shadowRoot;

          if (shadowRoot) {
            const iframe = shadowRoot.querySelector("iframe");

            if (iframe) {
              const iframeDoc =
                iframe.contentDocument || iframe.contentWindow.document;

              const button = iframeDoc.querySelector("button");
              if (button) {
                button.addEventListener("click", handleButtonClick);
              }

              const textarea = iframeDoc.querySelector("textarea");
              if (textarea) {
                textarea.addEventListener("keydown", handleEnterKeyPress);
              }
            }
          }
        });
      }

      document.addEventListener("DOMContentLoaded", () => {
        setupChatbotInteractions();
      });
    </script>
  </body>
</html>
